# ğŸªDBSHOP

[![JDK](https://img.shields.io/badge/JDK-1.8+-green.svg)](https://www.oracle.com/java/technologies/downloads)
[![Stars](https://img.shields.io/github/stars/leyunone/dbshop.svg?style=social)]()

## ğŸ”èƒŒæ™¯

åœ¨å¼€å‘æ–°éœ€æ±‚æˆ–å˜æ›´/è¿­ä»£æ—§åŠŸèƒ½æ—¶ï¼Œç»å¸¸ä¼šå‘ç”Ÿæ•°æ®åº“è¡¨å­—æ®µå˜æ›´æˆ–è¡¨æ–°å¢/ä¿®æ”¹ç­‰æ“ä½œï¼Œäºæ˜¯ç‰ˆæœ¬æ§åˆ¶çš„å¼€å‘æµç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå°†ä»£ç ï¼Œä»¥åŠæ•°æ®åº“å˜åŠ¨çš„SQLè¯­å¥ä¸€è‡´å‘å¸ƒåˆ°æµ‹è¯•ç¯å¢ƒï¼Œå†åˆ°æ­£å¼ç¯å¢ƒï¼›

é‚£ä¹ˆåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œéå¸¸å®¹æ˜“å¿½ç•¥æˆ–å¿˜è®°è‡ªå·±æ›¾å¯¹è¡¨ã€å¯¹å®ä½“ç±»çš„å˜æ›´ï¼Œè€Œå¦‚æœåˆ»æ„ä¸ºä¹‹ç¼–å†™ä¸šåŠ¡çš„è¿‡ç¨‹ä¸­åŠ ä¹‹è®°å½•çš„è¯å¾ˆå®¹æ˜“å½±å“å¼€å‘æ€è·¯ï¼›

è™½ç„¶ç›®å‰ä¸€äº›æ•°æ®åº“å·¥å…·ä¸­ï¼Œæ¯”å¦‚ `Navicat Premium`  ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ•°æ®ç»“æ„å¯¹æ¯”çš„å·¥å…·ä½¿ç”¨ï¼Œä½†éšç€æ•°æ®åº“çš„é€æ¸å¤æ‚ä¸é¡¹ç›®æ•°æ®åº“å¹´ä»£çš„æ›´è¿­ã€‚è¿™äº›å·¥å…·æ— æ³•ä¸ºæˆ‘ä»¬å¼€å‘è€…åšåˆ°è‡ªç”±åº¦é«˜çš„æ¯”å¯¹ï¼ˆæ¯”å¦‚å½“ä¸¤å¼ è¡¨çš„å¤‡æ³¨å‘ç”Ÿä»»ä½•å˜æ›´æ—¶ï¼Œéƒ½ä¼šäº§ç”ŸSQLï¼‰ï¼Œå¯¹æ¯”çš„è§„åˆ™éƒ½ç”±å·¥å…·æ–¹å®šä¹‰ï¼›

æ‰€ä»¥ä½œä¸ºå¼€å‘è€…çš„æˆ‘ä»¬ï¼Œæ›´å¸Œæœ›çš„æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰å¯¹æ¯”è¿‡ç¨‹ä¸­çš„è§„åˆ™ï¼Œæ¯”å¦‚æ— è§†å¤‡æ³¨ä¸åŒï¼Œè‡ªå®šä¹‰æ•°æ®ä¼˜åŒ–è§„åˆ™ç­‰ç­‰...

å› æ­¤è¿™ä¸ªå·¥å…·è¯ç”Ÿäº†ï¼Œä¸ºäº†å¦‚ä¸‹çš„å±•æœ›ï¼š

- è‡ªå®šä¹‰å¯¹æ¯”æ—¶çš„è§„åˆ™
- æ ¹æ®è‡ªå·±éœ€è¦ï¼Œå¯é…ç½®å¯¹æ¯”äº§ç”Ÿçš„SQLç±»å‹ï¼Œæ¯”å¦‚æˆ‘å¸Œæœ› `int(1)` å’Œ `bit(1)` è¿™ç§éƒ½ä¸º `tinyint(1)`
- ç»“åˆé¡¹ç›®ä¸æ•°æ®åº“ï¼Œå¯åŒå‘æ£€æŸ¥ä»£ç ä¸­æ²¡æœ‰ç”¨åˆ°çš„è¡¨å’Œå­—æ®µï¼Œå¹¶å°†ç»“æœæ‰“å°
- å¯è§†åŒ–é¡µé¢æ“ä½œï¼Œæœ€ç»ˆè¾¾åˆ°é€›æ•°æ®åº“å’Œé€›è¶…å¸‚ä¸€æ ·è‡ªç”±

## ğŸ“™åŠŸèƒ½ç‚¹

- å¼€ç®±å³ç”¨ï¼Œæ”¯æŒAPIè°ƒç”¨ã€é¡µé¢äº¤äº’ã€é…ç½®æ–‡ä»¶è‡ªåŠ¨æµä¸‰ç§æ¨¡å¼
- å¯è¿›è¡Œï¼šä¸¤è¡¨ä¹‹é—´ã€ä¸¤ä¸ªæ•°æ®åº“ä¹‹é—´ã€å¤šä¸ªæ•°æ®åº“ä¹‹é—´...çš„å¯¹æ¯”ï¼Œå¹¶è¾“å‡ºå¯¹æ¯”åçš„è¡¨ã€å­—æ®µã€å…ƒå±æ€§çº§ç»“æœ
- å¯æ”¯æŒï¼šSQLè¯­å¥ç±»å‹çš„è½¬åŒ–ç­–ç•¥ [tinyint(1) = tinyint(1) ]ã€[datetime(??) = datetime(0) ]... ç­‰è½¬åŒ–ç­–ç•¥
- å¯è‡ªåŠ¨å°è£…ï¼Œä½†ä¸é™äºï¼š1ã€æ–°å¢å­—æ®µï¼› 2ã€åˆ é™¤å­—æ®µ ï¼›3ã€å­—æ®µç±»å‹å˜æ›´ï¼›4ã€å­—æ®µå­—èŠ‚å˜æ›´ï¼›5ã€å­—æ®µå¤‡æ³¨å˜æ›´ï¼›6ã€è¡¨å¤‡æ³¨å˜æ›´ï¼›7ã€å­—æ®µè‡ªå¢æ–°å¢å’Œåˆ é™¤ï¼›8ã€è¡¨ä¸»é”®æ–°å¢æˆ–åˆ é™¤.....çš„SQLè¯­å¥
- å·²æä¾›ï¼šåŒå‘æ£€æŸ¥æ— ç”¨è¡¨ã€åŒå‘æ£€æŸ¥æ— ç”¨å­—æ®µã€æ•°æ®åº“å¯¹æ¯”APIå’Œé¡µé¢æ“ä½œ
- æ”¯æŒå¤šç§æ•°æ®åº“

## ä½¿ç”¨

ä¾èµ–SpringBootç¯å¢ƒ

å¼•å…¥ä¾èµ–ï¼š

```xml
<dependency>
  <groupId>com.leyunone</groupId>
  <artifactId>dbshop-core</artifactId>
  <version>1.0.2-SNAPSHOT</version>
</dependency>
```

### APIç‰ˆæœ¬ï¼ˆåˆ›å»ºå•å…ƒæµ‹è¯•Unitï¼‰

#### æ•°æ®åº“å¯¹æ¯”ï¼ˆæ•°æ®åº“æˆ–æŒ‡å®šè¡¨ï¼‰

ç›®å‰ä¸ºè¯•ç”¨ç‰ˆæœ¬ï¼Œåªæ”¯æŒMySqlæ•°æ®åº“ï¼Œå¹¶ä¸”åªæœ‰ä¸¤ç§ç±»å‹è½¬æ¢è§„åˆ™

```java
@SpringBootTest
public class ApiTestService {

    @Autowired
    private DbShopStartAPIService dbShopStartAPIService;
    
    @Test
    public void startTest(){
        DbShopDbDTO leftQuery = new DbShopDbDTO();
        leftQuery.setUrl("jdbc:mysql://127.0.0.1:3306/2024_test?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai&allowMultiQueries=true&nullCatalogMeansCurrent=true");
        leftQuery.setDbName("2024_test");
        leftQuery.setUserName("root");
        leftQuery.setPassWord("root");
        DbShopDbDTO rightQuery = new DbShopDbDTO();
        rightQuery.setUrl("jdbc:mysql://127.0.0.1:3306/2024_test_1?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai&allowMultiQueries=true&nullCatalogMeansCurrent=true");
        rightQuery.setDbName("2024_test_1");
        rightQuery.setUserName("root");
        rightQuery.setPassWord("root");
        SqlRuleDTO sqlRuleDTO = new SqlRuleDTO();
        //å¤‡æ³¨çº§å¯¹æ¯” 0å…³é—­ 1å¼€å¯
        sqlRuleDTO.setGoRemark(true);
        //æ·±åº¦å¯¹æ¯” 0å…³é—­ 1å¼€å¯
        sqlRuleDTO.setGoDeep(true);
        //é‚£å¼ ä¸ºä¸»è¡¨ 0 å·¦è¡¨  1 å³è¡¨
        sqlRuleDTO.setLeftOrRight(0);
        //æ˜¯å¦å°è£…åˆ é™¤è¡¨sql
        sqlRuleDTO.setDeleteTable(true);
        //ç±»å‹è½¬åŒ–è§„åˆ™        	       
        sqlRuleDTO.setTransformReg(MyCollectionUtils.newArrayList(DataTypeRegularEnum.BIT1_TO_TINYINT1, DataTypeRegularEnum.DATETIME_TO_0));
        dbShopStartAPIService.leftRightDbCompare(leftQuery, rightQuery, sqlRuleDTO);
    }
}
```

#### æ£€æŸ¥æ— ç”¨è¡¨

```java
    @Test
    public void checkUseLessTableTest() {
        DbShopDbDTO leftQuery = new DbShopDbDTO();
        leftQuery.setUrl("jdbc:mysql://127.0.0.1:3306/2024_test?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai&allowMultiQueries=true&nullCatalogMeansCurrent=true");
        leftQuery.setDbName("2024_test");
        leftQuery.setUserName("root");
        leftQuery.setPassWord("root");
        //TODO è¯¥å¯¹è±¡ä¸ºä½¿ç”¨è€…è‡ªè¡ŒæŒ‡å®šçš„ä¿®é¥°å®ä½“ç±»çš„è¡¨åæ³¨è§£ ä¸ºç©ºæ—¶ï¼Œä½¿ç”¨å·¥å…·å·²æ­é…çš„ä¸»æµæ³¨è§£ï¼š1\Mybatis-plus 2\....
        //AnnotateLoadingManager.AnnotateObject annotateObject = new AnnotateLoadingManager.AnnotateObject(VersionDescribe.class, "describe");
        dbShopStartAPIService.checkUselessTable(leftQuery, annotateObject);
    }
```

#### æŸ¥è¯¢æ— ç”¨å­—æ®µ

```java
    @Test
    public void checkUseLessFieldTest() {
        DbShopDbDTO leftQuery = new DbShopDbDTO();
        leftQuery.setUrl("jdbc:mysql://127.0.0.1:3306/2024_test?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai&allowMultiQueries=true&nullCatalogMeansCurrent=true");
        leftQuery.setDbName("2024_test");
        leftQuery.setUserName("root");
        leftQuery.setPassWord("root");
        //TODO è¯¥å¯¹è±¡ä¸ºä½¿ç”¨è€…è‡ªè¡ŒæŒ‡å®šçš„ä¿®é¥°å®ä½“ç±»çš„å­—æ®µåæ³¨è§£ ä¸ºç©ºæ—¶ï¼Œä½¿ç”¨å·¥å…·å·²æ­é…çš„ä¸»æµæ³¨è§£ï¼š1\Mybatis-plus 2\....
        //AnnotateLoadingManager.AnnotateObject annotateObject = new AnnotateLoadingManager.AnnotateObject(VersionDescribe.class, "describe");
        dbShopStartAPIService.checkTableColumnToCode(leftQuery,annotateObject);
    }
```

### é¡µé¢ç‰ˆæœ¬

å¼•å…¥ä¾èµ–

```xml
<dependency>
  <groupId>com.leyunone</groupId>
  <artifactId>dbshop-web</artifactId>
  <version>1.0.2-SNAPSHOT</version>
</dependency>
```

å¯åŠ¨é¡¹ç›®ï¼Œæ‰“å¼€é¡µé¢ï¼šhttp://localhost:{@your port}/{@your servlet-api}/dbshop/home

## **æ‰€æœ‰ä¾èµ–**

| ä¾èµ–        | è¯´æ˜                |
| ----------- | ------------------- |
| dbshop-api  | dbshop-APIç‰ˆæœ¬      |
| dbshop-web  | dbshop-é¡µé¢ç‰ˆæœ¬     |
| dbshop-core | dbshop-è‡ªåŠ¨è£…é…ç‰ˆæœ¬ |

## TODO

å·²ç»å®é™…å¸®åŠ©åˆ°æˆ‘éå¸¸å¤šçš„å·¥å…·ï¼Œå¸Œæœ›ä¹Ÿèƒ½å¸®åŠ©åˆ°å¤§å®¶

æ¬¢è¿ä»»ä½•éœ€æ±‚ä»»ä½•æ„è§ï¼Œå·¥å…·è¿˜åœ¨å¼€å‘ä¸­ï¼ŒåŠŸèƒ½æ•¬è¯·æœŸå¾…...

## ğŸš©FINALY

æ„è§æ”¶çº³åœ°ä¸è”ç³»æ–¹å¼ï¼š[https://leyunone.com/](https://leyunone.com/)